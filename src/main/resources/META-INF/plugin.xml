<idea-plugin>
    <id>com.github.idea-claude-code-gui</id>
    <name>Claude Code GUI</name>
    <vendor>CodeMossAI</vendor>

    <!-- Resource bundle for i18n -->
    <resource-bundle>messages.ClaudeCodeGuiBundle</resource-bundle>

    <description><![CDATA[
        <p><strong>Claude Code GUI</strong> - A powerful visual interface plugin that brings <strong>Claude Code</strong> and <strong>OpenAI Codex</strong> dual AI tools directly into IntelliJ IDEA, making AI-assisted programming more efficient and intuitive.</p>

        <h2>Dual AI Engine Support</h2>
        <ul>
            <li><strong>Claude Code</strong> - Anthropic's official AI programming assistant (Opus 4.5 and more)</li>
            <li><strong>OpenAI Codex</strong> - OpenAI's powerful code generation engine</li>
        </ul>

        <h2>Key Features</h2>
        <ul>
            <li><strong>Context-aware AI Assistant</strong>: Intelligent coding assistant with @file reference support</li>
            <li><strong>Image Support</strong>: Send images for visual requirement description</li>
            <li><strong>Agent System</strong>: Built-in agents for automated complex tasks</li>
            <li><strong>Skills Commands</strong>: Slash command system (/init, /review, etc.)</li>
            <li><strong>MCP Server</strong>: Extend AI capabilities with MCP protocol</li>
            <li><strong>Code DIFF</strong>: Visual code comparison and file navigation</li>
            <li><strong>Conversation Rewind</strong>: Flexible history adjustment</li>
            <li><strong>Session Management</strong>: History, favorites, search, and export</li>
            <li><strong>Theme Support</strong>: Dark/Light themes with IDE font sync</li>
            <li><strong>Permission Control</strong>: Comprehensive security management</li>
            <li><strong>Provider Management</strong>: cc-switch compatible</li>
        </ul>

        <h2>How to Use</h2>
        <ul>
            <li>Open the Claude Code GUI tool window from the right sidebar</li>
            <li>Select code and use <kbd>Ctrl+Alt+K</kbd> (Win/Linux) or <kbd>Cmd+Alt+K</kbd> (Mac) to send to AI</li>
            <li>Get instant AI-powered code assistance and intelligent suggestions</li>
        </ul>

        <hr/>

        <p><strong>Claude Code GUI</strong> - 一个功能强大的可视化界面插件，将 <strong>Claude Code</strong> 和 <strong>OpenAI Codex</strong> 双 AI 工具直接集成到 IntelliJ IDEA 中，让 AI 辅助编程变得更加高效和直观。</p>

        <h2>双 AI 引擎支持</h2>
        <ul>
            <li><strong>Claude Code</strong> - Anthropic 官方 AI 编程助手（支持 Opus 4.5 等多模型）</li>
            <li><strong>OpenAI Codex</strong> - OpenAI 强大的代码生成引擎</li>
        </ul>

        <h2>核心功能</h2>
        <ul>
            <li><strong>上下文感知助手</strong>：智能编程助手，支持 @文件引用</li>
            <li><strong>图片支持</strong>：发送图片可视化描述需求</li>
            <li><strong>Agent 系统</strong>：内置智能体自动化执行复杂任务</li>
            <li><strong>Skills 命令</strong>：斜杠命令系统（/init, /review 等）</li>
            <li><strong>MCP 服务器</strong>：通过 MCP 协议扩展 AI 能力</li>
            <li><strong>代码 DIFF</strong>：可视化代码对比和文件导航</li>
            <li><strong>对话回退</strong>：灵活调整对话历史</li>
            <li><strong>会话管理</strong>：历史记录、收藏、搜索和导出</li>
            <li><strong>主题支持</strong>：深色/浅色主题，支持 IDE 字体同步</li>
            <li><strong>权限控制</strong>：完善的安全管理</li>
            <li><strong>供应商管理</strong>：兼容 cc-switch</li>
        </ul>

        <h2>使用方法</h2>
        <ul>
            <li>从右侧边栏打开 Claude Code GUI 工具窗口</li>
            <li>选中代码后使用 <kbd>Ctrl+Alt+K</kbd>（Win/Linux）或 <kbd>Cmd+Alt+K</kbd>（Mac）发送给 AI</li>
            <li>即时获得 AI 驱动的代码辅助和智能建议</li>
        </ul>

        <p><em>Keywords: Claude, Claude Code, Codex, OpenCode, Gemini, AI Assistant, Code Generation, AI Coding, Productivity, Intelligent Code Assistant</em></p>
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <!-- Optional: Terminal support for terminal output monitoring -->
    <depends optional="true" config-file="terminal-features.xml">org.jetbrains.plugins.terminal</depends>
    <!-- Optional: Java support for enhanced context collection in Java/Kotlin IDEs -->
    <depends optional="true" config-file="java-features.xml">com.intellij.java</depends>
    <!-- Optional: Python support for enhanced context collection in PyCharm/IDEA with Python plugin -->
    <depends optional="true" config-file="python-features.xml">com.intellij.modules.python</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Claude Code GUI 工具窗口（包含历史记录功能） -->
        <toolWindow id="CCG"
                    anchor="right"
                    factoryClass="com.github.claudecodegui.ClaudeSDKToolWindow"
                    icon="/icons/cc-gui-icon.svg"
                    canCloseContents="true"/>

        <!-- Pre-extract AI Bridge on project open to avoid EDT freeze -->
        <postStartupActivity implementation="com.github.claudecodegui.startup.BridgePreloader"/>

        <!-- Cleanup old ai-bridge cache when plugin version changes -->
        <postStartupActivity implementation="com.github.claudecodegui.startup.PluginUpdateListener"/>

        <!-- Monitor Run/Debug Service Output -->
        <postStartupActivity implementation="com.github.claudecodegui.service.RunConfigMonitorService"/>

        <!-- StatusBar widget for task notification -->
        <statusBarWidgetFactory id="ClaudeStatusBarWidget"
                                implementation="com.github.claudecodegui.notifications.ClaudeStatusBarWidget$Factory"/>

        <!-- Notification group for DevTools and other balloon notifications -->
        <notificationGroup id="Claude Code GUI Notifications" displayType="BALLOON"/>
    </extensions>

    <actions>
        <!-- 发送选中代码到终端的Action -->
        <action id="ClaudeCodeGUI.SendSelectionToTerminalAction"
                class="com.github.claudecodegui.SendSelectionToTerminalAction"
                icon="/icons/send-to-terminal.svg">
            <!-- 添加到编辑器右键菜单（显示在最上面） -->
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt K"/>
            <keyboard-shortcut keymap="Mac OS X" first-keystroke="meta alt K"/>
            <keyboard-shortcut keymap="macOS" first-keystroke="meta alt K"/>
        </action>

        <!-- Quick Fix with Claude Action -->
        <action id="ClaudeCodeGUI.QuickFixWithClaudeAction"
                class="com.github.claudecodegui.QuickFixWithClaudeAction"
                icon="/icons/quick-fix.svg">
            <add-to-group group-id="EditorPopupMenu"
                           anchor="after"
                           relative-to-action="ClaudeCodeGUI.SendSelectionToTerminalAction"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift Q"/>
            <keyboard-shortcut keymap="Mac OS X" first-keystroke="meta shift Q"/>
            <keyboard-shortcut keymap="macOS" first-keystroke="meta shift Q"/>
        </action>

        <!-- Create New Tab Action (can be invoked via Find Action or programmatically) -->
        <action id="ClaudeCodeGUI.CreateNewTabAction"
                class="com.github.claudecodegui.CreateNewTabAction"
                icon="AllIcons.General.Add"
                text="New Chat Tab"
                description="Create a new chat tab in Claude Code GUI tool window"/>

        <!-- Rename Tab Action -->
        <action id="ClaudeCodeGUI.RenameTabAction"
                class="com.github.claudecodegui.RenameTabAction"
                icon="AllIcons.Actions.Edit"
                text="Rename Tab"
                description="Rename the current chat tab"/>

        <!-- Open DevTools Action for JCEF debugging -->
        <action id="ClaudeCodeGUI.OpenDevToolsAction"
                class="com.github.claudecodegui.OpenDevToolsAction"
                icon="AllIcons.Xml.Browsers.Chromium"
                text="Open DevTools"
                description="Open JCEF DevTools for debugging"/>

        <!-- 从文件树发送文件路径到输入框的 Action -->
        <action id="ClaudeCodeGUI.SendFilePathToInputAction"
                class="com.github.claudecodegui.SendFilePathToInputAction"
                icon="/icons/send-to-terminal.svg">
            <!-- 添加到项目文件树右键菜单 -->
            <add-to-group group-id="ProjectViewPopupMenu" anchor="first"/>
        </action>

        <!-- Generate Commit Message with AI Action -->
        <action id="ClaudeCodeGUI.GenerateCommitMessageAction"
                class="com.github.claudecodegui.GenerateCommitMessageAction"
                icon="/icons/logo-16.png">
            <!-- 添加到 VCS Commit 工具栏 -->
            <add-to-group group-id="Vcs.MessageActionGroup" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
